function bbparse(e){var a=/([^\\]|^)(\\\\)*(\[[^\]]+)/g,l=document,s=e=>l.createElement(e);e+="[/]";var i="b,i,s,u,img,code,pre,ul,ol,li".split(","),r=s("div");r.style.whiteSpace="pre-wrap";for(var t,c=[r],n=a.lastIndex=0;t=a.exec(e);){var p=t[3],d=e.slice(n,a.lastIndex-p.length);if(d.length)switch((r.tagName||"").toLowerCase()){case"img":r.src=d;break;case"a":r.href=r.href||d;default:r.appendChild(l.createTextNode(d))}if("/"==p[1]){var f=c.pop();if(r==f)return r;f.appendChild(r),r=f}else{if("*"==(p=p.slice(1).split("="))){var o=e.indexOf("\n",a.lastIndex);e=e.slice(0,o)+"[/]"+e.slice(o),p[0]="li"}"list"==p&&(p[0]="ul"),c.push(r);var h=p[1];if(p=p[0],i.indexOf(p)+1)r=s(p);else switch(p){case"url":r=s("a"),h&&(r.href=h);break;case"color":(r=s("span")).style.color=h;break;case"size":(r=s("span")).style.fontSize=h+"px"}}n=a.lastIndex+1}}