function bbparse(e){var a,i=/([^\\]|^)(\\\\)*(\[[^\]]+)/g,l=document,s=e=>l.createElement(e),r="b,i,s,u,img,code,pre,ul,ol,li".split(","),t=s("div"),c=[t],n=i.lastIndex=0;for(e+="[/]",t.style.whiteSpace="pre-wrap";a=i.exec(e);){var p=a[3],f=i.lastIndex,o=e.slice(n,f-p.length);if(o.length)switch((t.tagName||"").toLowerCase()){case"img":t.src=o;break;case"a":t.href=t.href||o;default:t.appendChild(l.createTextNode(o))}if("/"==p[1]){var d=c.pop();if(t==d)return t;d.appendChild(t),t=d}else{if("*"==(p=p.slice(1).split("="))){var h=e.indexOf("\n",f);e=e.slice(0,h)+"[/]"+e.slice(h),p[0]="li"}"list"==p&&(p[0]="ul"),c.push(t);var u=p[1];if(p=p[0],r.indexOf(p)+1)t=s(p);else switch(p){case"url":t=s("a"),u&&(t.href=u);break;case"color":(t=s("span")).style.color=u;break;case"size":(t=s("span")).style.fontSize=u+"px"}}n=f+1}}