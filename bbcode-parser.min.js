function bbparse(e){var a,i=/([^\\]|^)(\\\\)*(\[[^\]]+)/g,s=document,l=e=>s.createElement(e),t="b,i,s,u,img,code,pre,ul,ol,li".split(","),r=l("div"),c=[r],n=i.lastIndex=0;for(e+="[/]",r.style.whiteSpace="pre-wrap";a=i.exec(e);){var p=a[3],f=i.lastIndex,d=e.slice(n,f-p.length);if(d.length)switch((r.tagName||"").toLowerCase()){case"img":r.src=d;break;case"a":r.href=r.href||d;default:r.appendChild(s.createTextNode(d))}if("/"==p[1]){var o=c.pop();if(r==o)return r;o.appendChild(r),r=o}else{if("*"==(p=p.slice(1).split("="))){var h=e.indexOf("\n",f);e=e.slice(0,h)+"[/]"+e.slice(h),p[0]="li"}"list"==p&&(p[0]="ul"),c.push(r);var u=p[1];if(p=p[0],t.indexOf(p)+1)r=l(p);else switch(p){case"url":r=l("a"),u&&(r.href=u);break;case"color":(r=l("span")).style[p]=u;break;case"size":(r=l("span")).style.fontSize=u+"px"}}n=f+1}}